<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>配車調整アプリ - 利用マニュアル</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-feature-settings: "palt";
        }
        h2 {
            border-bottom: 2px solid #60A5FA; /* blue-400 */
            padding-bottom: 8px;
            margin-top: 2.5rem; /* mt-10 */
            margin-bottom: 1rem; /* mb-4 */
        }
        h3 {
            border-left: 5px solid #93C5FD; /* blue-300 */
            padding-left: 10px;
            margin-top: 2rem; /* mt-8 */
            margin-bottom: 0.75rem; /* mb-3 */
        }
        .step {
            background-color: #EFF6FF; /* blue-50 */
            border: 1px solid #BFDBFE; /* blue-200 */
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem; /* p-4 */
            margin-bottom: 1rem; /* mb-4 */
        }
        .caution {
            background-color: #FFFBEB; /* yellow-50 */
            border: 1px solid #FDE68A; /* yellow-200 */
            color: #B45309; /* yellow-700 */
            padding: 1rem; /* p-4 */
            border-radius: 0.5rem; /* rounded-lg */
        }
    </style>
</head>
<body class="bg-gray-100 font-sans leading-relaxed text-gray-800">

    <div class="container mx-auto p-4 md:p-10 max-w-3xl bg-white shadow-lg rounded-lg my-10">
        <h1 class="text-4xl font-bold text-center text-gray-800 mb-8">
            配車調整アプリ 利用マニュアル
        </h1>

        <!-- アプリの概要 -->
        <section class="mb-10 text-center">
            <p class="text-lg">
                このアプリは、チームの遠征やイベントなどで「誰がどの車に乗るか」を自動で割り当てるためのツールです。
            </p>
            <p class="mt-2 text-gray-600">
                「どの車がどの駐車場に停めるか」も自動で振り分けます。
            </p>
        </section>

        <!-- ★★★ 警告: データ保存について ★★★ -->
        <div class="caution mb-10">
            <h3 class="text-xl font-bold mt-0 mb-2 text-yellow-800">！ 必ずお読みください：データの保存について</h3>
            <p>
                このアプリは、入力したデータ（参加者や車のリスト、作成した割り当て結果など）を、お使いの**ブラウザ（ChromeやSafariなど）の中だけ**に保存します。
            </p>
            <ul class="list-disc list-inside mt-3 space-y-1">
                <li>サーバーやクラウドには送信されません。</li>
                <li>スマホやPCを買い替えたり、別のブラウザを使うと、データは引き継がれません。</li>
                <li>ブラウザの履歴やキャッシュを消去すると、データも**すべて消えてしまう**可能性があります。</li>
            </ul>
            <p class="mt-3 font-bold">
                大切なデータ（特に「マスターデータ」）は、こまめに「マスターを保存(JSON)」ボタンからファイルとして書き出し、バックアップ（予備を保存）するようにしてください。
            </p>
        </div>


        <!-- 基本的な使い方（メインアプリ） -->
        <h2 class="text-3xl font-bold text-gray-700">基本的な使い方 (メインアプリ)</h2>
        <p class="mb-6">
            メインアプリ（index.html）を開き、上から下へ順番に情報を入力・選択していきます。
        </p>

        <div class="step">
            <h3 class="text-xl font-bold mt-0">ステップ1： 参加者を選択</h3>
            <p>
                「家族・グループ」ごとに、今回のイベントに参加する人のチェックボックスを「オン」にします。
            </p>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li>「全員参加」ボタンを押すと、その家族全員にチェックが入ります。</li>
                <li>「同乗優先」がオンになっている人（主に選手）は、「学年」や「学校」などの入力欄が表示されます。ここに入力しておくと、割り当て時に同じ学年・学校の子がなるべく同じ車に集まるようになります。</li>
            </ul>
        </div>

        <div class="step">
            <h3 class="text-xl font-bold mt-0">ステップ2： 車とドライバーを選択</h3>
            <p>
                今回出す車にチェックを「オン」にします。<br>
                チェックを入れると、追加の選択肢が表示されます。
            </p>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li><strong>ドライバー:</strong> 運転する人を必ず選んでください。</li>
                <li><strong>荷物あり:</strong> 旗やボール、テントなどの大きな荷物を積む場合、チェックを入れます。チェックを入れると、安全のため、その車の定員が自動的に「2名（ドライバー＋1名）」として計算されます。</li>
            </ul>
        </div>

        <div class="step">
            <h3 class="text-xl font-bold mt-0">ステップ3： 別便の人を除外</h3>
            <p>
                ステップ1で「参加する」にチェックした人（ドライバーを除く）のうち、
                「現地集合」や「自転車で行く」など、配車が不要な人がいれば、ここでチェックを「オン」にします。
            </p>
            <p class="mt-2 text-sm text-gray-600">
                ※ここでチェックした人は、最後の「割り当て結果」で「別便」の欄にまとめられます。
            </p>
        </div>

        <div class="step">
            <h3 class="text-xl font-bold mt-0">ステップ4： グラウンド・駐車場と割り当て実行</h3>
            <p>
                目的地の情報を入力し、「割り当て実行」ボタンを押します。
            </p>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li><strong>グラウンド名:</strong> 「SF (ホーム)」や「〇〇小学校」など、場所の名前を入力します。</li>
                <li><strong>指定駐車場:</strong> チームの車を停めるよう指定された駐車場の名前（例: A面）、台数制限、地図URLなどの備考を入力します。</li>
                <li><strong>指定以外の駐車場:</strong> それ以外の車を停める場所（例: 丘の上）の情報を入力します。</li>
            </ul>
            <p class="mt-3 font-bold">
                入力が終わったら、<span class="bg-blue-600 text-white py-1 px-2 rounded-md">割り当て実行</span> ボタンを押してください。
            </p>
        </div>

        <div class="step">
            <h3 class="text-xl font-bold mt-0">ステップ5： 割り当て結果（と手動調整）</h3>
            <p>
                自動で割り当てられた結果がカード形式で表示されます。<br>
                結果が気に入らない場合は、手動で入れ替えることができます。
            </p>
            <h4 class="font-semibold mt-3 mb-1">■ 人を入れ替える方法</h4>
            <ol class="list-decimal list-inside ml-4 space-y-1">
                <li>入れ替えたい1人目（例: Aさん）の横にあるチェックボックスを「オン」にします。（薄い青色になります）</li>
                <li>入れ替えたい2人目（例: Bさん、または「空席」）のチェックボックスを「オン」にします。</li>
                <li>瞬時にAさんとBさんが入れ替わります。</li>
            </ol>
            <h4 class="font-semibold mt-3 mb-1">■ 車の駐車場を入れ替える方法</h4>
            <ol class="list-decimal list-inside ml-4 space-y-1">
                <li>入れ替えたい1台目（例: 小高カー）の「車の名前」の横にあるチェックボックスを「オン」にします。</li>
                <li>入れ替えたい2台目（例: 難波カー）の「車の名前」の横にあるチェックボックスを「オン」にします。</li>
                <li>2台の停める駐車場（指定／指定以外）が入れ替わります。</li>
            </ol>
            
            <h4 class="font-semibold mt-3 mb-1">■ テキスト出力</h4>
            <p class="ml-4">
                「テキスト出力」ボタンを押すと、LINEなどで連絡しやすい形式のテキストが表示されます。「コピー」ボタンでコピーして使えます。
            </p>
        </div>

        <!-- データ操作 -->
        <h2 class="text-3xl font-bold text-gray-700">作業の保存・復元 (メインアプリ)</h2>
        <p class="mb-6">
            メインアプリの上部には、作業内容を保存したり、過去の作業を呼び出したりするボタンがあります。
        </p>
        <div class="step">
            <h3 class="text-xl font-bold mt-0">作業状態の保存・復元 (DB)</h3>
            <p>
                「今、誰にチェックをつけたか」「どの車を選んだか」という作業途中の状態を、お使いのブラウザに5件まで保存できます。（名前をつけて保存できます）
            </p>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li><span class="font-bold text-green-700">「現在の状態をDBに保存」:</span> 今の状態を保存します。</li>
                <li><span class="font-bold text-yellow-700">「保存した状態を選択...」:</span> 過去に保存した状態を選んで「読込」ボタンで復元します。</li>
                <li><span class="font-bold text-red-700">「削除する状態を選択...」:</span> 不要になった保存データを選んで「削除」ボタンで消せます。</li>
            </ul>
        </div>
        <div class="step">
            <h3 class="text-xl font-bold mt-0">駐車場データの保存・復元 (DB)</h3>
            <p>
                ステップ4で入力した「グラウンド名」や「駐車場の情報」を、ブラウザに20件まで保存できます。（名前をつけて保存できます）<br>
                よく行くグラウンドの情報を保存しておくと、次回から選ぶだけで入力が完了します。
            </p>
        </div>
        <div class="step">
            <h3 class="text-xl font-bold mt-0">キャッシュ全クリア (DB初期化)</h3>
            <p class="font-bold text-red-700">
                ！注意！ このボタンを押すと、マスターデータ、保存した状態、保存した駐車場など、ブラウザに保存したすべてのデータが消え、アプリが最初の状態に戻ります。
            </p>
            <p class="mt-2">
                アプリの動きが完全におかしくなった場合や、すべてをリセットしたい場合の最終手段です。
            </p>
        </div>


        <!-- マスターデータ管理 -->
        <h2 class="text-3xl font-bold text-gray-700">最重要：マスターデータの管理</h2>
        <p class="mb-6">
            「マスターデータ」とは、アプリの大元となる「家族・参加者リスト」と「車リスト」のことです。<br>
            メインアプリの右上にある「マスターデータ管理」ボタンから、専用ページ（master.html）に移動して編集します。
        </p>
        <div class="step">
            <h3 class="text-xl font-bold mt-0">家族・参加者の編集</h3>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li><strong>家族・グループを追加:</strong> 新しい家族（例: 鈴木家）やグループ（例: コーチ）を追加します。</li>
                <li><strong>メンバーを追加:</strong> 家族カードの中にあるボタンで、その家族に新しい人（例: 鈴木父）を追加します。</li>
                <li><strong>名前・タイプの変更:</strong> 表示されている入力欄を直接書き換えると、自動で保存されます。</li>
                <li><strong>同乗優先 (旧: 当番対象):</strong> チェックをオンにすると、メインアプリで「学年」「学校」などの入力欄が表示され、割り当て時に考慮されるようになります。<span class="font-bold">選手や当番対象の兄弟はオン</span>に、保護者やスタッフはオフにするのがオススメです。</li>
                <li><strong>並び替え (▲ ▼):</strong> 家族・グループの表示順を入れ替えます。メインアプリのステップ1の表示順もこれと同じになります。</li>
            </ul>
        </div>
        <div class="step">
            <h3 class="text-xl font-bold mt-0">車の編集</h3>
            <ul class="list-disc list-inside mt-2 ml-4 space-y-1">
                <li><strong>車を追加:</strong> 新しい車を追加します。IDは自動で決まります。</li>
                <li><strong>関連する家族:</strong> 車の持ち主の家族を選んでおくと、メインアプリのステップ2で、その家族からドライバーを自動で選びやすくなります。</li>
                <li><strong>並び替え (▲ ▼):</strong> 車の表示順を入れ替えます。メインアプリのステップ2の表示順もこれと同じになります。</li>
            </ul>
        </div>
        <div class="step caution">
            <h3 class="text-xl font-bold mt-0">マスターの保存 (JSON)</h3>
            <p class="font-bold">
                これが最も重要なバックアップ機能です。
            </p>
            <p class="mt-2">
                編集が終わったら、必ず<span class="bg-blue-600 text-white py-1 px-2 rounded-md">マスターを保存 (JSON)</span> ボタンを押してください。<br>
                <span class="font-bold">`car_assignment_master_....json`</span> というファイルがダウンロードされます。
            </p>
            <p class="mt-2">
                このファイルをPCやGoogleドライブなど、安全な場所に保存しておけば、万が一ブラウザのデータが消えても、
                <span class="bg-purple-500 text-white py-1 px-2 rounded-md">マスターを読み込む (JSON)</span> ボタンからこのファイルを選ぶだけで、すべてのデータを元に戻せます。
            </p>
        </div>

    </div>

</body>
</html>

